import{r as o,j as e,H as he,a as z}from"./app-DqmTMYm-.js";import{a as ae,B as a}from"./app-logo-icon-D8O_JSdh.js";import{u as ue,a as je,F as ge,B as I,b as Y,c as W,d as K,e as Q,f as X,h as pe,o as fe,E as P,i as $,P as F,s as Z,C as f,t as D,v as k,x as N,S as Ne,G as be,q as we,l as ve,r as ee,w as Me,y as ye,j as H,z as Ce,D as Se,H as V,I as y,J as De,K as b,T as ke,A as Ee,k as Fe}from"./schemas-0l4ZyNiN.js";import{L as B,I as G}from"./label-CNk8XO4b.js";import{D as te,a as re,b as le,c as ce,d as ne,e as ie}from"./dialog-CBBv5jgl.js";import{l as Te,U as E,t as w}from"./app-layout-1MO7xTHo.js";/* empty css            */import"./index-Cj8ARCk4.js";import"./index-DR9Bojdv.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]],se=ae("Mail",Le);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Oe=ae("User",Ae),Ue=fe({name:Z().min(1,"Name is required").max(100,"Name must be less than 100 characters"),email:Z().email("Please enter a valid email address").max(100,"Email must be less than 100 characters")});function _e({isOpen:g,onClose:n,mode:l,member:t,onSave:T}){const i=ue({resolver:je(Ue),defaultValues:{name:"",email:""}});o.useEffect(()=>{t&&(l==="edit"||l==="view")?i.reset({name:t.name,email:t.email}):l==="create"&&i.reset({name:"",email:""})},[t,l,g,i]);const v=c=>{l!=="view"&&(T?.(c),n())},p=()=>{switch(l){case"create":return"Add New Member";case"edit":return"Edit Member";case"view":return"Member Details";default:return""}},L=()=>{switch(l){case"create":return e.jsx(F,{className:"h-4 w-4"});case"edit":return e.jsx($,{className:"h-4 w-4"});case"view":return e.jsx(P,{className:"h-4 w-4"});default:return null}},M=()=>{switch(l){case"create":return"Add a new member to your library system.";case"edit":return"Make changes to this member's information.";case"view":return"View this member's details.";default:return""}},m=l==="view",C=l==="edit",x=l==="create";return e.jsx(te,{open:g,onOpenChange:n,children:e.jsxs(re,{className:"sm:max-w-[425px]",children:[e.jsxs(le,{children:[e.jsxs(ce,{className:"flex items-center gap-2",children:[L(),p()]}),e.jsx(ne,{children:M()})]}),e.jsx(ge,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(v),className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 py-4",children:[(m||C)&&t&&e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(B,{htmlFor:"membercode",className:"text-right",children:"Member Code"}),e.jsx("div",{className:"col-span-3",children:e.jsx(I,{variant:"secondary",className:"text-sm",children:t.membercode})})]}),e.jsx(Y,{control:i.control,name:"name",render:({field:c})=>e.jsxs(W,{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(K,{className:"text-right",children:"Name"}),e.jsxs("div",{className:"col-span-3 space-y-2",children:[e.jsx(Q,{children:e.jsx(G,{placeholder:"Enter member name",disabled:m,...c})}),e.jsx(X,{})]})]})}),e.jsx(Y,{control:i.control,name:"email",render:({field:c})=>e.jsxs(W,{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(K,{className:"text-right",children:"Email"}),e.jsxs("div",{className:"col-span-3 space-y-2",children:[e.jsx(Q,{children:e.jsx(G,{type:"email",placeholder:"Enter email address",disabled:m,...c})}),e.jsx(X,{})]})]})}),m&&t&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(B,{className:"text-right text-sm text-muted-foreground",children:"Created"}),e.jsx("div",{className:"col-span-3",children:e.jsx("span",{className:"text-sm text-muted-foreground",children:new Date(t.created_at||"").toLocaleDateString()})})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(B,{className:"text-right text-sm text-muted-foreground",children:"Updated"}),e.jsx("div",{className:"col-span-3",children:e.jsx("span",{className:"text-sm text-muted-foreground",children:new Date(t.updated_at||"").toLocaleDateString()})})]})]})]}),e.jsx(ie,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(a,{type:"button",variant:"outline",onClick:n,children:"Cancel"}),!m&&e.jsxs(a,{type:"submit",className:"flex items-center gap-2",children:[e.jsx(pe,{className:"h-4 w-4"}),x?"Add Member":"Save Changes"]})]})})]})})]})})}const ze=[{title:"Dashboard",href:"/dashboard"},{title:"Members",href:"/members"}];function Re({members:g=[]}){const[n,l]=o.useState(""),[t,T]=o.useState(g),[i,v]=o.useState("grid"),[p,L]=o.useState("name"),[M,m]=o.useState("asc"),[C,x]=o.useState(!1),[c,q]=o.useState({isOpen:!1,mode:"create",selectedMember:null}),[h,J]=o.useState({isOpen:!1,selectedMember:null});o.useEffect(()=>{T(g)},[g]);const S=t.filter(s=>s.name.toLowerCase().includes(n.toLowerCase())||s.email.toLowerCase().includes(n.toLowerCase())||s.membercode.toLowerCase().includes(n.toLowerCase())).sort((s,r)=>{let d=s[p],u=r[p];return typeof d=="string"&&(d=d.toLowerCase(),u=u.toLowerCase()),M==="asc"?d<u?-1:d>u?1:0:d>u?-1:d<u?1:0}),j=(s,r)=>{console.log("Opening modal:",s,r),q({isOpen:!0,mode:s,selectedMember:r||null})},A=()=>{console.log("Closing modal"),q({isOpen:!1,mode:"create",selectedMember:null})},R=s=>{console.log("Opening delete modal for member:",s),J({isOpen:!0,selectedMember:s})},O=()=>{console.log("Closing delete modal"),J({isOpen:!1,selectedMember:null})},de=s=>{x(!0),z.post("/members",s,{onSuccess:()=>{w.success("Member Added",{description:`"${s.name}" has been successfully added as a member.`}),A()},onError:r=>{console.error("Error creating member:",r),w.error("Error",{description:"Failed to add member. Please try again."})},onFinish:()=>x(!1)})},oe=s=>{c.selectedMember&&(x(!0),console.log("Updating member:",c.selectedMember.id,s),z.patch(`/members/${c.selectedMember.id}`,s,{onSuccess:()=>{console.log("Update successful"),w.success("Member Updated",{description:`"${s.name}" has been successfully updated.`}),A()},onError:r=>{console.error("Error updating member:",r),w.error("Error",{description:"Failed to update member. Please try again."})},onFinish:()=>x(!1)}))},me=()=>{if(!h.selectedMember)return;x(!0);const s=h.selectedMember;console.log("Deleting member:",s.id),z.delete(`/members/${h.selectedMember.id}`,{onSuccess:()=>{console.log("Delete successful"),w.success("Member Deleted",{description:`"${s.name}" has been successfully removed from the system.`}),O()},onError:r=>{console.error("Error deleting member:",r),w.error("Error",{description:"Failed to delete member. Please try again."})},onFinish:()=>x(!1)})},U=s=>{p===s?m(M==="asc"?"desc":"asc"):(L(s),m("asc"))},_=s=>p!==s?null:M==="asc"?e.jsx(Ee,{className:"h-4 w-4"}):e.jsx(Fe,{className:"h-4 w-4"});return e.jsxs(Te,{breadcrumbs:ze,children:[e.jsx(he,{title:"Members"}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold tracking-tight flex items-center gap-2",children:[e.jsx(E,{className:"h-8 w-8"}),"Members"]}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your library members and their information."})]}),e.jsxs(a,{onClick:()=>j("create"),className:"flex items-center gap-2",children:[e.jsx(F,{className:"h-4 w-4"}),"Add Member"]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(f,{children:[e.jsxs(D,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(k,{className:"text-sm font-medium",children:"Total Members"}),e.jsx(E,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(N,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Registered members"})]})]}),e.jsxs(f,{children:[e.jsxs(D,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(k,{className:"text-sm font-medium",children:"New This Month"}),e.jsx(Oe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(N,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.filter(s=>{const r=new Date(s.created_at),d=new Date,u=d.getMonth(),xe=d.getFullYear();return r.getMonth()===u&&r.getFullYear()===xe}).length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"New registrations"})]})]}),e.jsxs(f,{children:[e.jsxs(D,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(k,{className:"text-sm font-medium",children:"Active Members"}),e.jsx(se,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(N,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All members active"})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx(Ne,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(G,{placeholder:"Search members by name, email, or code...",value:n,onChange:s=>l(s.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(a,{variant:i==="grid"?"default":"outline",size:"sm",onClick:()=>v("grid"),children:e.jsx(be,{className:"h-4 w-4"})}),e.jsx(a,{variant:i==="table"?"default":"outline",size:"sm",onClick:()=>v("table"),children:e.jsx(we,{className:"h-4 w-4"})})]})]}),e.jsxs(ve,{value:i,onValueChange:s=>v(s),children:[e.jsx(ee,{value:"grid",className:"mt-0",children:S.length===0?e.jsx(f,{children:e.jsxs(N,{className:"flex flex-col items-center justify-center py-16",children:[e.jsx(E,{className:"h-16 w-16 text-muted-foreground/50"}),e.jsx("h3",{className:"text-lg font-semibold mt-4",children:"No members found"}),e.jsx("p",{className:"text-muted-foreground text-center max-w-sm",children:n?"Try adjusting your search terms":"Get started by adding your first member"}),!n&&e.jsxs(a,{onClick:()=>j("create"),className:"mt-4",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Add First Member"]})]})}):e.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:S.map(s=>e.jsxs(f,{className:"hover:shadow-md transition-shadow",children:[e.jsx(D,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(k,{className:"text-lg",children:s.name}),e.jsxs(Me,{className:"flex items-center gap-1",children:[e.jsx(se,{className:"h-3 w-3"}),s.email]})]}),e.jsx(I,{variant:"secondary",children:s.membercode})]})}),e.jsx(N,{className:"pt-0",children:e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Joined ",new Date(s.created_at).toLocaleDateString()]})}),e.jsxs(ye,{className:"flex gap-2",children:[e.jsxs(a,{variant:"outline",size:"sm",onClick:()=>j("view",s),className:"flex-1",children:[e.jsx(P,{className:"h-4 w-4 mr-1"}),"View"]}),e.jsxs(a,{variant:"outline",size:"sm",onClick:()=>j("edit",s),className:"flex-1",children:[e.jsx($,{className:"h-4 w-4 mr-1"}),"Edit"]}),e.jsx(a,{variant:"outline",size:"sm",onClick:()=>R(s),className:"text-red-600 hover:text-red-700",children:e.jsx(H,{className:"h-4 w-4"})})]})]},s.id))})}),e.jsx(ee,{value:"table",className:"mt-0",children:e.jsx(f,{children:e.jsx(N,{className:"p-0",children:e.jsxs(Ce,{children:[e.jsx(Se,{children:e.jsxs(V,{children:[e.jsx(y,{children:e.jsxs(a,{variant:"ghost",onClick:()=>U("membercode"),className:"h-auto p-0 font-semibold hover:bg-transparent",children:["Member Code",_("membercode")]})}),e.jsx(y,{children:e.jsxs(a,{variant:"ghost",onClick:()=>U("name"),className:"h-auto p-0 font-semibold hover:bg-transparent",children:["Name",_("name")]})}),e.jsx(y,{children:e.jsxs(a,{variant:"ghost",onClick:()=>U("email"),className:"h-auto p-0 font-semibold hover:bg-transparent",children:["Email",_("email")]})}),e.jsx(y,{children:"Join Date"}),e.jsx(y,{className:"text-right",children:"Actions"})]})}),e.jsx(De,{children:S.length===0?e.jsx(V,{children:e.jsx(b,{colSpan:5,className:"text-center py-8",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx(E,{className:"h-12 w-12 text-muted-foreground/50"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"No members found"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:n?"Try adjusting your search terms":"Get started by adding your first member"})]}),!n&&e.jsxs(a,{onClick:()=>j("create"),children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Add First Member"]})]})})}):S.map(s=>e.jsxs(V,{children:[e.jsx(b,{children:e.jsx(I,{variant:"secondary",children:s.membercode})}),e.jsx(b,{className:"font-medium",children:s.name}),e.jsx(b,{children:s.email}),e.jsx(b,{children:new Date(s.created_at).toLocaleDateString()}),e.jsx(b,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(a,{variant:"ghost",size:"sm",onClick:()=>j("view",s),children:e.jsx(P,{className:"h-4 w-4"})}),e.jsx(a,{variant:"ghost",size:"sm",onClick:()=>j("edit",s),children:e.jsx($,{className:"h-4 w-4"})}),e.jsx(a,{variant:"ghost",size:"sm",onClick:()=>R(s),className:"text-red-600 hover:text-red-700",children:e.jsx(H,{className:"h-4 w-4"})})]})})]},s.id))})]})})})})]}),e.jsx(_e,{isOpen:c.isOpen,onClose:A,mode:c.mode,member:c.selectedMember,onSave:c.mode==="create"?de:oe}),e.jsx(te,{open:h.isOpen,onOpenChange:O,children:e.jsxs(re,{className:"sm:max-w-[425px]",children:[e.jsxs(le,{children:[e.jsxs(ce,{className:"flex items-center gap-2 text-destructive",children:[e.jsx(ke,{className:"h-5 w-5"}),"Delete Member"]}),e.jsx(ne,{children:"This action cannot be undone. This will permanently delete the member from your system."})]}),h.selectedMember&&e.jsx("div",{className:"py-4",children:e.jsxs("div",{className:"rounded-lg border border-destructive/20 bg-destructive/5 p-4",children:[e.jsx("h4",{className:"font-semibold text-destructive mb-2",children:"Member to be deleted:"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Name:"})," ",h.selectedMember.name]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Email:"})," ",h.selectedMember.email]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Member Code:"})," ",h.selectedMember.membercode]})]})]})}),e.jsxs(ie,{className:"gap-2",children:[e.jsx(a,{variant:"outline",onClick:O,children:"Cancel"}),e.jsxs(a,{variant:"destructive",onClick:me,className:"gap-2",disabled:C,children:[e.jsx(H,{className:"h-4 w-4"}),C?"Deleting...":"Delete Member"]})]})]})})]})]})}export{Re as default};
